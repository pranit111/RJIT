{% extends 'dyslexia/base.html' %}
{% load static %}

{% block dyslexia_content %}
<div class="dashboard-container">
    <div class="dashboard-header">
        <h1>Welcome to Your Learning Dashboard</h1>
        <p class="welcome-text">Hello, {{ user_profile.user.username }}!</p>
    </div>

    <div class="dashboard-grid">
        <!-- Profile Summary Card -->
        <div class="dashboard-card">
            <h2>Your Profile</h2>
            <div class="profile-info">
                <div class="info-item">
                    <span class="label">Condition Level:</span>
                    <span class="value">{{ user_profile.get_condition_level_display }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Dyslexia Type:</span>
                    <span class="value">{{ dyslexia_profile.get_dyslexia_type_display }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Dyslexia Level:</span>
                    <span class="value">{{ dyslexia_profile.get_dyslexia_level_display }}</span>
                </div>
            </div>
        </div>

        <!-- Test Results Summary -->
        <div class="dashboard-card">
            <h2>Test Results</h2>
            <div class="score-summary">
                <div class="overall-score">
                    <div class="score-circle">
                        <span class="percentage">{{ overall_percentage }}%</span>
                        <span class="label">Overall Score</span>
                    </div>
                </div>
                
                <div class="section-scores">
                    <div class="score-item">
                        <h3>Phonological</h3>
                        <div class="progress-bar">
                            <div class="progress" style="width: {{ section_percentages.phonological }}%"></div>
                        </div>
                        <span class="score">{{ section_percentages.phonological|floatformat:1 }}%</span>
                    </div>
                    
                    <div class="score-item">
                        <h3>Surface</h3>
                        <div class="progress-bar">
                            <div class="progress" style="width: {{ section_percentages.surface }}%"></div>
                        </div>
                        <span class="score">{{ section_percentages.surface|floatformat:1 }}%</span>
                    </div>
                    
                    <div class="score-item">
                        <h3>Visual</h3>
                        <div class="progress-bar">
                            <div class="progress" style="width: {{ section_percentages.visual }}%"></div>
                        </div>
                        <span class="score">{{ section_percentages.visual|floatformat:1 }}%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detailed Scores -->
        <div class="dashboard-card full-width">
            <h2>Detailed Scores</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Section</th>
                            <th>Score</th>
                            <th>Total Questions</th>
                            <th>Percentage</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Phonological</td>
                            <td>{{ test_result.phonological_score }}</td>
                            <td>{{ total_questions.phonological }}</td>
                            <td>{{ section_percentages.phonological|floatformat:1 }}%</td>
                        </tr>
                        <tr>
                            <td>Surface</td>
                            <td>{{ test_result.surface_score }}</td>
                            <td>{{ total_questions.surface }}</td>
                            <td>{{ section_percentages.surface|floatformat:1 }}%</td>
                        </tr>
                        <tr>
                            <td>Visual</td>
                            <td>{{ test_result.visual_score }}</td>
                            <td>{{ total_questions.visual }}</td>
                            <td>{{ section_percentages.visual|floatformat:1 }}%</td>
                        </tr>
                        <tr class="total-row">
                            <td><strong>Total</strong></td>
                            <td><strong>{{ test_result.total_score }}</strong></td>
                            <td><strong>{{ total_questions.total }}</strong></td>
                            <td><strong>{{ overall_percentage|floatformat:1 }}%</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<style>
    .dashboard-container {
        padding: 2em;
        max-width: 1200px;
        margin: 0 auto;
    }

    .dashboard-header {
        text-align: center;
        margin-bottom: 2em;
    }

    .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2em;
    }

    .dashboard-card {
        background: #ffffff;
        border-radius: 10px;
        padding: 2em;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .full-width {
        grid-column: 1 / -1;
    }

    .info-item {
        background: #f8f9fa;
        padding: 1em;
        border-radius: 8px;
        margin-bottom: 1em;
    }

    .score-circle {
        width: 200px;
        height: 200px;
        border-radius: 50%;
        background: #f8f9fa;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin: 0 auto 2em;
        border: 8px solid #007bff;
    }

    .score-circle .percentage {
        font-size: 2.5em;
        font-weight: bold;
        color: #007bff;
    }

    .score-circle .label {
        color: #666;
        margin-top: 0.5em;
    }

    .progress-bar {
        width: 100%;
        height: 20px;
        background: #f0f0f0;
        border-radius: 10px;
        overflow: hidden;
        margin: 1em 0;
    }

    .progress {
        height: 100%;
        background: #007bff;
        transition: width 0.3s ease;
    }

    .score-item {
        margin-bottom: 2em;
    }

    .score-item h3 {
        margin-bottom: 0.5em;
        color: #333;
    }

    .table-container {
        overflow-x: auto;
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        padding: 1em;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }

    th {
        background: #f8f9fa;
    }

    .total-row {
        background: #f8f9fa;
    }

    @media (max-width: 768px) {
        .dashboard-container {
            padding: 1em;
        }

        .score-circle {
            width: 150px;
            height: 150px;
        }

        .score-circle .percentage {
            font-size: 2em;
        }
    }
</style>
{% endblock %} 